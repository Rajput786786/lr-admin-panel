<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LR OWNER PANEL</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
margin:0;
font-family:Arial;
background:linear-gradient(135deg,#071226,#0f1f3d);
color:white;
}

.hidden{display:none}

.center{
height:100vh;
display:flex;
justify-content:center;
align-items:center;
}

.box{
background:rgba(255,255,255,0.05);
padding:40px;
border-radius:20px;
box-shadow:0 0 30px rgba(0,255,255,0.4);
width:320px;
text-align:center;
}

input{
width:100%;
padding:10px;
margin:10px 0;
background:transparent;
border:none;
border-bottom:2px solid rgba(255,255,255,0.4);
color:white;
}

button{
padding:10px 20px;
border:none;
border-radius:20px;
background:linear-gradient(90deg,#00eaff,#0088ff);
color:white;
cursor:pointer;
box-shadow:0 0 10px cyan;
margin-top:10px;
}

#error{
color:red;
margin-top:10px;
}

.header{
display:flex;
justify-content:space-between;
padding:20px;
font-size:20px;
color:#00f7ff;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginPage" class="center">
<div class="box">
<h2 style="color:#00f7ff;">LR OWNER PANEL</h2>
<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Password">
<button onclick="login()">LOGIN</button>
<div id="error"></div>
</div>
</div>

<!-- PANEL -->
<div id="panelPage" class="hidden">
<div class="header">
<span id="panelTitle"></span>
<button onclick="logout()">LOG OUT</button>
</div>

<div style="padding:20px;">
<h3 id="roleText"></h3>
</div>
</div>

<script>

const { createClient } = supabase;

const client = createClient(
"https://dpskhodrzlnqczibolug.supabase.co",
"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRwc2tob2RyemxucWN6aWJvbHVnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwMjU1MTcsImV4cCI6MjA4NzYwMTUxN30.53CxPWtg_-PpDt_reNsxE1A4KupdhFfv6wbB3HsuhNs"
);

async function login(){

const email=document.getElementById("email").value.trim();
const password=document.getElementById("password").value;
const errorBox=document.getElementById("error");
errorBox.textContent="";

if(!email || !password){
errorBox.textContent="Email and Password required";
return;
}

const { error } = await client.auth.signInWithPassword({
email,
password
});

if(error){
errorBox.textContent=error.message;
return;
}

loadUser();
}

async function loadUser(){

const { data:{ user } } = await client.auth.getUser();
if(!user) return;

const { data } = await client
.from("profiles")
.select("*")
.eq("id", user.id)
.single();

if(!data){
alert("Profile not found");
return;
}

document.getElementById("loginPage").classList.add("hidden");
document.getElementById("panelPage").classList.remove("hidden");

document.getElementById("panelTitle").innerText="LR "+data.role.toUpperCase()+" PANEL";
document.getElementById("roleText").innerText="Logged in as: "+data.email+" ("+data.role+")";
}

async function logout(){
await client.auth.signOut();
location.reload();
}

loadUser();

</script>

</body>
</html>
